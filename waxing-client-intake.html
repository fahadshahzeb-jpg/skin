<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hair Removal Service - Client Intake Form</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; max-width: 600px; margin: auto; }
        .form-section { margin-bottom: 25px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        label { font-weight: bold; display: block; margin-top: 10px; }
        input[type="text"], input[type="date"], textarea, select { width: 95%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; border-radius: 4px; }
        canvas { border: 2px solid #333; cursor: crosshair; margin-top: 10px; width: 100%; height: auto; }
        button { padding: 12px; margin-top: 20px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; width: 100%; }
    </style>
</head>
<body>

    <h2>Hair Removal Service - Client Intake Form</h2>

    <form id="clientForm">
        <div class="form-section">
            <label>Client Name:</label>
            <input type="text" name="clientName" required>
            <label>Client Number:</label>
            <input type="text" name="clientNumber" required>
            <label>Date:</label>
            <input type="date" name="date" required>
        </div>

        <div class="form-section">
            <label>1. Wax method preference?</label>
            <input type="radio" name="waxMethod" value="Tin"> Tin
            <input type="radio" name="waxMethod" value="Roll-on"> Roll-on
            
            <label>2. Wax flavour preference?</label>
            <select name="waxFlavour">
                <option value="Honey">Honey (Sensitive)</option>
                <option value="Banana">Banana (Normal)</option>
            </select>
        </div>

        <div class="form-section">
            <label>Customer Signature:</label>
            <canvas id="customerSign" width="400" height="150"></canvas>
            <button type="button" onclick="clearCanvas('customerSign', custCtx)" style="width: auto; background: #666;">Clear</button>
        </div>

        <button id="submitBtn">Submit Form</button>
    </form>

    <script>
        const scriptUrl = 'YOUR_APPS_SCRIPT_URL_HERE';

        const custCanvas = document.getElementById("customerSign");
        const custCtx = custCanvas.getContext("2d");
        setupDrawing(custCanvas, custCtx);

        function setupDrawing(canvas, ctx) {
            let isDrawing = false;
            let lastX = 0, lastY = 0;
            function getCoords(e) {
                const rect = canvas.getBoundingClientRect();
                const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                const clientY = e.touches ? e.touches[0].clientY : e.clientY;
                return { x: clientX - rect.left, y: clientY - rect.top };
            }
            const start = (e) => { isDrawing = true; const {x, y} = getCoords(e); [lastX, lastY] = [x, y]; };
            const move = (e) => {
                if (!isDrawing) return;
                const {x, y} = getCoords(e);
                ctx.beginPath(); ctx.moveTo(lastX, lastY); ctx.lineTo(x, y); ctx.stroke();
                [lastX, lastY] = [x, y];
                if(e.touches) e.preventDefault();
            };
            canvas.addEventListener("mousedown", start); canvas.addEventListener("mousemove", move);
            canvas.addEventListener("touchstart", start); canvas.addEventListener("touchmove", move);
            window.addEventListener("mouseup", () => isDrawing = false);
            window.addEventListener("touchend", () => isDrawing = false);
        }

        function clearCanvas(id, ctx) { ctx.clearRect(0, 0, 400, 150); }

        document.getElementById('submitBtn').addEventListener('click', function(e) {
            e.preventDefault();
            this.disabled = true;
            this.innerText = "Submitting...";

            const formData = new FormData(document.getElementById('clientForm'));
            formData.append("customerSignature", custCanvas.toDataURL("image/png"));

            fetch(scriptUrl, { method: 'POST', body: formData })
            .then(() => { alert("Success!"); location.reload(); })
            .catch(() => { alert("Error!"); this.disabled = false; });
        });
    </script>
</body>
</html>
